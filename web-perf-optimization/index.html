<html lang="en" xmlns="http://www.w3.org/1999/html">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=1024" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <title>Web Performance Optimization Tips</title>

    <meta name="description" content=""/>
    <meta name="author" content="Serban Balamaci" />

    <!--<link href="http://fonts.googleapis.com/css?family=Corben:400,700" rel="stylesheet" type="text/css">-->
    <link rel="stylesheet" href="../css/style.css">
    <link rel="stylesheet" href="css/perf.css">

    <link href='http://git-scm.com/favicon.ico' rel='shortcut icon' type='image/x-icon'>

    <!--<link href="http://fonts.googleapis.com/css?famly=Open+Sans:regular,semibold,italic,italicsemibold|PT+Sans:400,700,400italic,700italic|PT+Serif:400,700,400italic,700italic" rel="stylesheet" />-->

    <style type="text/css">
        .background {
            position: fixed;
            height: 100%;
            width: 100%;
            background: -moz-radial-gradient(50% 50%, farthest-side, #fff, #efefef);
            background: -webkit-gradient(radial, 50% 50%, 350, 50% 50%, 750, from(#fff), to(#bbb));
            z-index: 0;
        }
        .white {
            height: 100%;
            width: 100%;
            background: #fff;
        }
    </style>
</head>
<body class="impress-not-supported background">
<div class="fallback-message">
    <p>Your browser <b>doesn't support the features required</b> by impress.js, so you are presented with a simplified version of this presentation.</p>
    <p>For the best experience please use the latest <b>Chrome</b>, <b>Safari</b> or <b>Firefox</b> browser.</p>
</div>

<div id="impress">
<div id="subject" class="step" data-x="-5000" data-y="-1500" data-scale="10">
    <h1>Web Performance</h1>
    <h2 style="margin-top: 10px;">Optimization Tips</h2>
    <div>
        <a href="https://github.com/balamaci/presentations/tree/master/web-perf-optimization">See Detailed Summary</a>
    </div>
    <img src="http://upload.wikimedia.org/wikipedia/commons/thumb/3/34/Florida_Box_Turtle_Digon3.jpg/320px-Florida_Box_Turtle_Digon3.jpg"/>
</div>



<div id="tools" class="step" data-x="500" data-y="-6500" data-scale="2">
    <h3>The Tools</h3>
    <ul class="topics left" style="width:350px;">
        <li><span class="title">YSLow / PageSpeed</span></li>
        <li>
            <span class="title"><a href="http://www.webpagetest.org/">WebPageTest</a></span>
            <span class="desc">
                <a href="http://gtmetrix.com/">GMetrix</a>
                <a href="http://pageload.monitis.com/">Monotis</a>
                <a href="http://tools.pingdom.com/">Pingdom</a>
                <a href="http://site-perf.com/">SitePerf</a>
            </span>
            <span class="title"><a href="https://developers.google.com/speed/pagespeed/insights">Pagespeed Insights-Critical path</a></span>

        </li>

        <li><span class="title"><a href="http://stevesouders.com/cuzillion/">Cuzzilion</a> / <a href="https://github.com/alessioalex/DelayME">DelayMe</a></span></li>
        <li><span class="title"><a href="chrome://net-internals">chrome://net-internals</a></span></li>
        <li><span class="title"><a href="http://www.browserscope.org/">BrowserScope</a></span></li>
        <li><span class="title"><a href="http://caniuse.com/">CanIUse</a></span></li>
        <li><span class="title"><a href="http://zoompf.com/free">ZoomPF Free</a></span></li>
        <li><span class="title"><a href="http://yahoo.github.com/boomerang/doc/">boomerang</a></span></li>
    </ul>
    <div>
        <img src="http://img.ehowcdn.com/article-new/ehow/images/a01/ui/kt/increase-download-speed-800x800.jpg" alt="" width="400"/>
    </div>
</div>


<div id="waterfall" class="step" data-x="3000" data-y="-5000" data-scale="2" style="padding: 0">
    <div style="width: 500px;" class="left">
        <a href="#" onclick="window.open('http://www.webpagetest.org/waterfall.php?test=121017_Z8_X2C', '_blank');">
            <img src="http://www.webpagetest.org/waterfall.php?test=121017_Z8_X2C&run=1&cached=0" alt="" width="500"/>
        </a>
    </div>
    <ul class="topics-small right" style="width: 400px;">
        <li>
            <span class="title">Reduce RTT and data exchanged on the wire</span>
            <span class="desc">-Use Keep-Alive header to reuse connections(default for Http 1.1)</span>
            <span class="desc">-Use a CDN</span>
            <span class="desc">-Minify resources and apply compression</span>
        </li>
        <li>
            <span class="title">Minimize number of requests</span>
            <span class="desc">Browsers are limited to 6 concurrent connections per host name</span>
            <span class="desc">-Merge resources - JS, CSS and Sprites for images</span>
            <span class="desc">-Use Data-URIs</span>
        </li>
        <li>
            <span class="title">Try to make more simultaneous requests</span>
            <span class="desc">-JS and CSS files at the head block rendering</span>
            <span class="desc">Arrange the request flow so that requests do not block and serialize</span>
        </li>
        <li>
            <span class="title">Progressive enhancement</span>
            <span class="desc">Determine a set of "critical path" resources that are required for rendering the page in a seeming usable state for the user</span>
            <span class="desc">Improve user experience by downloading in "the background" additional JS, resources for functionality as the user decides what to do next.</span>
        </li>
        <li>
            <span class="title">Cache is king</span>
            <span class="desc">"Fastest web request is the one not made"</span>
        </li>
    </ul>
</div>

<div id="cdn" class="step" data-x="6000" data-y="-5000" data-scale="2">
    <h3>Use a CDN</h3>
    <img src="img/cdn.png" alt="CDN"/>
    <ul class="topics">
        <li>Faster connections and downloads - reduced latency</li>
        <li>Domain sharding - more concurrent connections</li>
        <li>Reduced load on own servers</li>
    </ul>
</div>

<div id="how_cdn_work" class="step" data-x="9000" data-y="-5000" data-scale="2">
        <pre class="code left" style="width:600px;">
<b>$ dig js.web.de</b>
js.web.de.              CNAME   js.web.de.edgekey.net.
js.web.de.edgekey.net   CNAME   e5416.g.akamaiedge.net.
e5416.g.akamaiedge.net. A       2.16.109.234</pre>
    <div class="left">
        <img src="img/dns.png" alt="DNS"/>
    </div>
    <div class="right" style="width: 250px;">
        <h3>How do they work?</h3>
        <ul class="topics-small">
            <li><b>CNAME</b> is an alias</li>
            <li>Use GeoIp to check supplied A record</li>
            <li>Google Public DNS used to make CDNs missperform</li>
        </ul>
    </div>
</div>
<div id="custom_origin" class="step" data-x="12000" data-y="-5000" data-scale="2">
    <div>Common misconception that CDNs only act as a mirroring server</div>
    <div style="font-size: 0.7em;">They can act as a Reverse Proxy - Custom Origin(CloudFront)</div>
    <img src="http://www.nczonline.net/blog/wp-content/uploads/2011/11/cdn2.png" alt="">
</div>

<div id="benefits" class="step" data-x="15000" data-y="-5000" data-scale="2">
    <ul class="topics">
        <li>
            <span class="title">Domain sharding: Split statics to multiple CDNs</span>
            <span class="desc"><b>js.web.de</b>, <b>css.web.de</b>, <b>img.web.de</b> - further => <b>img1.web.de</b></span>
            <span class="desc"> <b>(+)</b> Max concurrent connections for resource retrieval increase</span>
            <span class="desc"> <b>(-)</b> Relative referencing no longer works : `background-image:url('../img/paper.gif');`</span>
            <span class="desc"> <span>Solution:</span> Using placeholders that are replaced at build time: `background-image:url('${img_cdn}/paper.gif');` </span>
            <span class="desc"> <b>(-)</b> Additional DNS lookups to resolve subdomains</span>
        </li>
        <li style="margin-top: 30px;">
            <span class="title">Most famous JS libraries have already known CDN locations to use</span>
            <span class="desc">Using those may mean that the library it's already in cache when a user comes for the first time</span>
            <span class="desc">Checkout <a href="http://cdnjs.com/index.html">cndjs</a> to add</span>
            <span class="desc">DON'T use GitHub references: <i>http://bartaz.github.com/impress.js/js/impress.js</i> They don't set any caching headers.</span>
        </li>
    </ul>

</div>

<div id="merging" class="step" data-x="500" data-y="-3000" data-scale="2">
    <h3>JS and CSS merging and minification</h3>

    <ul class="topics-small">
        <li>Reason behind merging of JS and CSS resources is related to making fewer requests</li>
        <img src="https://developers.google.com/speed/docs/insights/images/externaljs1.png"/>
        <li>
            <span class="title">Older browsers used to serialize downloads of JS resources</span>
            <span class="desc">They wanted to prevent unnecessary downloading of resources - eventual <i>document.write("&lt!--")</i></span>
        </li>
        <li>
            <span class="title">No longer true for more recent browsers(IE8 included)</span>
        </li>
    </ul>
    <img src="img/apple-waterfall-small.png"/>
</div>

<div id="minify" class="step" data-x="3000" data-y="-3000" data-scale="2">
    <h3>Minification</h3>
    <ul class="topics-small">
        <li>
            <span class="title">Removes spaces and comments, renames function and variable names</span>
        </li>
        <li>
            <span class="title">You'd expect the same result with gzipping the JS/CSS resource - actually it's a 5-10% more decrease in size</span>
        </li>
        <li>
            <span class="title">Wide selection of tools for minification</span>
            <span class="desc">Uglify.js, Google Closure, YUIMin, Jawr for CSS, etc - check what works for you</span>
        </li>
        <li>
            <span class="title">Use <a href="http://code.google.com/p/wro4j/">wro4j</a></span>
            <span class="desc">Has all the above mentioned options for minifying and merging plus other useful plugins</span>
        </li>
    </ul>
</div>

<div id="wro4j" class="step" data-x="5000" data-y="-3000" data-scale="2" style="padding: 0">
    <h3>wro4j - Web Resource Optimization for Java</h3>

    <div>Brings the concept of "groups of resources"</div>
    <div>Groups can be defined in a <b>wro4j.xml</b> file</div>

        <pre class="code left" style="width:400px;">
&lt;groups xmlns="http://www.isdc.ro/wro"&gt;
  &lt;group name="core"&gt;
    &lt;js&gt;/js/views/app-view.js&lt;/js&gt;
    &lt;js&gt;/js/views/file-browser-view.js&lt;/js&gt;
    &lt;js&gt;/js/models/*.js&lt;/js&gt;
    &lt;js&gt;classpath:com/mysite/resource/js/1.js&lt;/js&gt;
    &lt;css&gt;classpath:com/mysite/resource/css/1.css&lt;/css&gt;
    &lt;group-ref&gt;plugins&lt;/group-ref&gt;
  &lt;/group&gt;

  &lt;group name="plugins"&gt;
    &lt;js&gt;/js/plugins/jquery.modal.js&lt;/js&gt;
    &lt;js&gt;/js/plugins/jquery.progressbar.js&lt;/js&gt;
  &lt;/group&gt;
&lt;/groups&gt;
        </pre>

<pre class="code right" style="width:350px;">
&lt;html&gt;
  &lt;head&gt;
    &lt;title&gt;Wro Test&lt;/title&gt;

    &lt;link rel="stylesheet" type="text/css"
                href="/wro/core.css" /&gt;
    &lt;script type="text/javascript"
                src="/wro/core.js">&lt;/script&gt;
  &lt;/head&gt;
  &lt;body&gt;
      //Body
  &lt;/body&gt;
&lt;/html&gt;
</pre>
    <ul class="topics-small">
        <li>
            <span class="title">Run at build time</span>
            <span class="desc">Maven plugin to execute build step</span>
            <span class="desc">Command line <i>java -jar wro4j-runner-1.4.5-jar-with-dependencies.jar</i></span>
        </li>
        <li>
            <span class="title">At runtime</span>
            <span class="desc">Servlet filter to add to <b>web.xml</b> that applies per request the grouping and processors</span>
        </li>
    </ul>
</div>

<div id="wro4j_processors" class="step" data-x="8000" data-y="-3000" data-scale="2" style="padding: 0">
    <ul class="topics-small">
        <li>
            <h3>Pre/Post "Processors"</h3>
            <span class="desc">Set of plugins that alter the file before or after the merging into groups</span>
            <span class="desc">Defined in <b>wro.properties</b> </span>
            <pre class="code-small">
preProcessors=lessCss,cssDataUri,placeholderProcessor
postProcessors=jsMin,cssMinJawr
            </pre>
        </li>

        <li>
            <span class="title"><b>Minifiers</b></span>
            <span class="desc">JSMin, UglifyJs, yuiJs, yuiCss, JawrCss, etc.</span>
        </li>
        <li>
            <span class="title"><b>LESS Processor</b></span>
            <span class="desc">You can also include <b>.less</b> files as group resources and it will trigger <b>less.js</b> to parse those files into <b>.css</b></span>
        </li>
        <li>
            <span class="title"><b>Base64DataUriSupport</b></span>
            <span class="desc">This processor looks for <i>'background-image'</i> and if the referenced image is less than 32KB(IE8 limit for data-uris) transform it do data-uri <div class="red-dot">.</div></span>
        </li>
        <li>
            <span class="title"><b>PlaceholderProcessor</b></span>.
            <span class="desc">Replace ${var_name} with actual values in the resources</span>
        </li>
        <li>
            <span class="title"><b>JSLint</b> and <b>CSSLint</b></span>.
            <span class="desc">Static analysis - "Findbugs" for JS and CSS</span>
        </li>
    </ul>
</div>

<div id="gzip" class="step" data-x="11000" data-y="-3000" data-scale="2" style="padding: 0">
    <h3>Compressing text on the wire</h3>
    <ul class="topics-small">
        <li>
            Browser and Server negotiate on the compression protocol that will be used to exchange information with each request.
        </li>
        <li>
            <div>Browser negotiate the possible communication by sending a header in the request:</div>
            <div><b>Accept-Encoding: gzip, deflate, sdch</b></div>
            <div>Server responds with the compressed content plus the header</div>
            <div><b>Content-Encoding: gzip</b></div>
        </li>

        <li>Not only text can be compressed, .ico and web fonts. Good text candidates .xml, .rss, json content type</li>
        <li>Should not set it for resources that are already compressed like .png or .gif, .jpeg</li>
        <li>Best use the <a href="https://github.com/h5bp/html5-boilerplate/blob/master/.htaccess">.htaccess</a> file from the <a href="http://html5boilerplate.com/">HTML5 Boilerplate</a> project as example</li>
    </ul>

</div>

<div id="caching" class="step" data-x="500" data-y="0" data-scale="2">
    <h3>Browser Caching</h3>
    <div>There are several headers that specify how the resources get cached</div>
    <ul class="topics">
        <li>
            <span class="title"><b>Expires Sun, 14 Jan 2014 08:23:12 GMT</b> and <b>Cache-Control: max-age=</b>3600 are <b>"hard"</b> cache directives</span>
                <span class="desc"> - When the browser encounters one of those headers it will cache the resource and for
                    the time specified will consider it fresh and will not try to revalidate and download by issuing other
                    GET request to the server.
                </span>
            <span class="desc"> - It's redundant to set both <b>Expires</b> and <b>Cache-Control</b>, because <b>Cache-Control</b> always takes precedence over the other</span>
        </li>
    </ul>
    <img src="img/king_cache.jpg" width="200">
</div>

<div id="caching2" class="step" data-x="3500" data-y="0" data-scale="2" style="padding: 0;">
    <ul class="topics">
        <li>
            <span class="title"><b>Last-Modified</b> and <b>ETag</b> are "soft" caching helpers</span>
            <span class="desc">The browser may issue GET requests to the server to check if the resource has been changed on the server.</span>
        </li>
    </ul>
    <ul class="topics">
        <li style="width: 400px;" class="left">
            <span class="title"><b>Last-Modified</b>:Sun, 19 Jun 2011 06:59:22 GMT</span>
            <span class="desc">1. If the resource's valid period had expired browser may issue GET requests with <b>If-Modified-Since</b> header</span>
            <span class="desc">2. Server may just return an empty response content body but with <b>304 Not Modified</b> status</span>

            <img src="http://betterexplained.com/wp-content/uploads/compression/HTTP-caching-last-modified_1.png" alt=""/>
        </li>
        <li style="width: 350px;clear: none;" class="left">
            <span class="title"><b>ETag</b>:"bc10321a2179"</span>
            <span class="desc">Is a programatically generated value to mean an unique identifier for a resource, a fingerprint or version</span>
            <span class="desc">Same logic, only the server has to respond to a check request header <b>If-None-Match</b>if there is a new version of the resource</span>
            <img src="http://betterexplained.com/wp-content/uploads/compression/HTTP_caching_if_none_match.png" alt=""/>
        </li>
        <li>
            <span class="title">Problem with <b>ETag</b></span>
            <span class="desc">The value may be different for the same resources if the request lands on different servers</span>
            <span class="desc">For Apache one can configure <b>FileETag none</b> in the <b>.htaccess</b> file</span>
        </li>
        <li>
            <span class="title">Browser can set both <b>If-Modified-Since</b> and <b>If-None-Match</b> to check validity</span>
        </li>
    </ul>
</div>
<div id="cache_using" class="step" data-x="6500" data-y="0" data-scale="2" style="padding: 0;">

    <ul class="topics">
        <li>
            <span class="title"><b>Apparent conflict</b></span>
            <span class="title">1. We are advised to set <b>Far Future Expiration dates</b> like months for <b>js</b>, <b>css</b></span>
            <span class="title">2. We want the users to see immediately a new version(fix) of a script / css quickly not wait for a week / month </span>
        </li>
        <li>
            <span class="title"><b>Solution</b>: Reference the cacheable resource along with some kind of version token in a file that is not cached (the .html) file</span>
            <ul class="topics-small">
                <li>
                    <span class="title">- <b>Timestamp of files</b></span>
                    <span class="title">&lt;script type="text/javascript" src="/js/site-B0439F858745C84EA46792F9AC42B6CF.js"&gt;&lt;/script&gt;</span>
                </li>
                <li>
                    <span class="title">- <b>Specific file version</b></span>
                    <span class="title">&lt;script type="text/javascript" src="/js/site.js?ver=1.23"&gt;&lt;/script&gt;</span>
                </li>
                <li>
                    <span class="title">- <b>Application version</b></span>
                    <span class="title">&lt;script type="text/javascript" src="/2.14/js/site.js"&gt;&lt;/script&gt;</span>
                </li>
            </ul>
        </li>
    </ul>
    <ul class="topics" style="margin-top:20px;">
        <li><span class="title"><b>Apache config</b></span></li>
        <li>
            <span class="title">To enable browser caching we are enabling in Apache the <b>mod_expires</b> module</span>
            <pre class="code">
<IfModule mod_expires.c>
    ExpiresActive on
    ExpiresByType text/css                  "access plus 1 year"
    ExpiresByType application/javascript    "access plus 1 year"
</IfModule>
            </pre>
        </li>
        <li>
            <span class="title">This only updates the cache related headers in the browser</span>
            <span class="desc">Does not mean we've turned the Apache frontend into a <b>Caching Reverse Proxy</b></span>
        </li>
    </ul>

</div>

<div id="proxy_cache" class="step" data-x="9500" data-y="0" data-scale="2" >
    <h3>Caching reverse proxy</h3>
    <img src="img/proxy_cache.jpg" height="400"/>
    <ul class="topics">
        <li><span class="title">Apache <b>mod_cache</b> no longer experimental since 2.2</span></li>
        <li><span class="title">Uses the <b>Cache Control</b> and <b>Expires</b> header to know when to request again</span></li>
        <li><span class="title"><b>Varnish Cache</b> - more configurable can sit in front of the Apache</span></li>
        <li><span class="title">Nginx - also has the possibility to cache proxy requests</span></li>
    </ul>
</div>

<div id="block" class="step" data-x="3000" data-y="3000" data-scale="2" style="padding: 0;">
    <h3>JS behaves like a Primadona! When browsers encounter a &lt;script&gt; tag they block until they finish downloading and execute the script</h3>
    <div style="width: 500px;" class="left">
        <img src="img/script.png" alt="" style="padding-left: 50px;"/>
        <ul class="topics left">
            <li>
                <span class="title">The page seems unresponsive to the user during this time</span>
                <span class="desc">If the script is in the <b>&lt;head&gt;</b> section nothing will render</span>
                <span class="desc">The rendering process is interrupted</span>
            </li>
            <li>
                <span class="title">Why block and not continue?</span>
                <span class="desc">Browser cannot begin executing bellow scripts(even if they finished downloading before the blocking one) because they might rely on code being available.</span>
                <span class="desc">Think of your libraries that are dependent on <b>JQuery</b></span>
            </li>
            <li>
                <span class="title">What can Browsers do?</span>
                <span class="desc">- Only look ahead and start downloading(but NOT executing) following scripts.</span>
                <span class="desc">- Remember older browsers didn't even do that.</span>
            </li>
        </ul>
    </div>
    <div class="right">
        <img src="img/tackle.jpg"/>
    </div>
</div>

<div id="break" class="step" data-x="6000" data-y="3000" data-scale="2" style="padding: 0;">
    <h3 class="title">What can we do?</h3>
    <div>
        <ul class="topics">
            <li>
                <span class="title">Move scripts to page bottom</span>
                <span class="desc">Prevent render blocking by moving the script as down in the page as possible => bottom script</span>
                <span class="desc">(+) User will see the page render</span>
                <span class="desc">(-) User interactions with "active" components will not work until dependant js script is downloaded and executed</span>
            </li>
            <li><span class="title">Look for and remove <b>404s</b> when referencing external JS files</span></li>
            <li>
                <span class="title">Look for empty JS files</span>
                <span class="desc">They'll block needlessly until response comes</span>
            </li>
        </ul>
    </div>
</div>

<div id="asyncscript" class="step" data-x="9000" data-y="3000" data-scale="2" style="padding: 0;">
    <h3>Your script killed my site - Beware of SPOFs from 3rd party scripts</h3>
    <img src="img/images.jpg"/>

    <ul class="topics">
        <li>
            <span class="title">Make the scripts not blocking, make them <b>async</b></span>
            <span class="desc"><b>HTML5 introduced the &lt;script async="async"&gt;</b> attribute. See <a href="http://caniuse.com/">CanIUse</a> for support(&lt;IE10 don't)</span>
            <span class="desc">When async script is encountered, browser begins downloading and executes it as soon as available</span>
        </li>
        <li>
            <span class="title">With <b>async</b> you don't get any guarantees about order of execution</span>
            <span class="desc">Can't assume that one async script will load before another async script.</span>
            <span class="desc">3rd Party scripts on which you don't depend are ideal candidates:  GA, Facebook, Tweeter, LinkedIn libraries</span>
            <span class="desc">You fire the requests in parallel and there is no blocking.</span>
        </li>
        <li>
            <span class="title"><b>DOMContentLoaded</b> event aka $.ready() happens faster</span>
            <span class="desc">Because it does not wait for JS to download and execute</span>
            <span class="desc">Your script is not delayed by any other 3rd party slow response</span>
        </li>
        <li>
            <span class="title">Don't use <b>document.write()</b> in scripts</span>
        </li>
    </ul>

</div>

<div id="dynamic" class="step" data-x="12000" data-y="3000" data-scale="2" style="padding: 0;">
    <h3>Dynamic Script Tag Injection because IE<10 does not support async</h3>

    <pre class="code">
var sNew = document.createElement("script");
sNew.async = true; //does not mean that when we set to false
sNew.src = "http://ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js";
var s0 = document.getElementsByTagName('script')[0];
s0.parentNode.insertBefore(sNew, s0);
    </pre>

    <ul class="topics">
        <li>
            <span class="title">Advantage when keeping the scripts at the &lt;head&gt;</span>
            <span class="desc">The browser can begin downloading the script early</span>
        </li>
        <li>
            <span class="title">What about if you'd want to execute a callback when the async script finishes loading?</span>
            <span class="desc">You can listen for the <b>onload</b> event on the script. For IE this is <b>onreadystatechanged</b></span>

        </li>
        <li>
            <span class="title">What if you also have dependent libraries?</span>
            <span class="desc">JQuery &lt;&lt; Bootstrap.js &lt;&lt; inline script</span>
            <span class="desc">Things get messy and we need to resort to a specialized async loader - there are quite
                <a href="https://docs.google.com/spreadsheet/ccc?key=0Aqln2akPWiMIdERkY3J2OXdOUVJDTkNSQ2ZsV3hoWVE#gid=2">a bunch</a> of them </span>
            <span class="desc">Is it worth the additional of another js library?</span>
        </li>
    </ul>
</div>

<div id="deffered" class="step" data-x="15000" data-y="3000" data-scale="2" style="padding: 0;">
    <h3>Async vs Deffered</h3>
    <div>IE also had from a long time the <b>defer</b> attribute for scripts</div>
    <pre class="code">&lt;script defer="defer" src="http://ajax.googleapis.com/.../jquery.min.js"&gt;</pre>
    <ul class="topics">
        <li >
            <span class="title">Like async when a <b>defer</b> script is encountered the <b>parsing and rendering does not block</b></span>
        </li>
        <li>
            <span class="title">Execution is deferred until the DOM is constructed</span>
        </li>
        <li>
            <span class="title">Execution order of scripts is preserved so <b>scripts block one another</b> but not page rendering</span>
        </li>
        <li><span class="title"><b>Transfer-Encoding: Chuncked</b></span> for <a href="#" onclick="window.open('http://www.webpagetest.org/waterfall.php?test=121017_Z8_X2C', '_blank');">slow response</a> servers</li>
    </ul>
</div>

<div id="image-defered" class="step" data-x="3000" data-y="6000" data-scale="2" style="padding: 0;">
    <div>
        <h3>Load non visible / non essential images at a later time</h3>
        <ul class="topics">
            <li>Think of Gravatar, Disqus user images, carroussel other non essential</li>
            <li><span class="title">The browser does not know that images are not visible and will try to download them when &lt;img <b>src="photo.jpg"</b>&gt; encountered</span></li>
        </ul>
    </div>
    <pre class="code" style="clear:left;">
&lt;img src="placeholder.png" data-original="tiger.jpg"&gt;
&lt;noscript&gt;&lt;img src="tiger.jpg"&gt;&lt;/noscript&gt;
</pre>

<pre class="code" style="clear:left;">
function deferredImageLoading() {
    $('img[data-src]').each(function() {
        $(this).attr('src', $(this).attr('data-src'));
    });
}
</pre>

    <div>
    </div>
</div>

<div id="spdy" class="step" data-x="3000" data-y="9000" data-scale="2" style="padding: 0;">
    <h3>SPDY or HTML2.0</h3>
    <div class="left">
        <img src="https://encrypted-tbn3.gstatic.com/images?q=tbn:ANd9GcTOw5PwszRB_wIkAHR8BMnLlsDAYLBwQ0Pw3WWXb4WKamSZAbgB" width="400"/>
    </div>

    <ul class="topics right" style="width: 400px;">
        <li><span class="title">Compressed Headers</span>
            <span class="desc">Currently -in HTTP- the headers are sent uncompressed</span>
        </li>
        <li>
            <span class="title">Multiplexing resources on a single connection</span>
            <span class="desc">Single long lasting connection to the server without the need to "warm up" to a high bandwidth</span>
            <span class="desc">We need to do the opposite of domain sharding</span>
        </li>
        <li>
            <span class="title">Server Push</span>
        </li>
        <li>
            <span class="title">Preemptive resource loading</span>
        </li>
    </ul>
</div>

</div>

<script src="http://bartaz.github.com/impress.js/js/impress.js"></script>
<script>impress().init();</script>

</body>
</html>